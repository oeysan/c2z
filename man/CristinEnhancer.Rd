% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cristin_enhancer.R
\name{CristinEnhancer}
\alias{CristinEnhancer}
\title{Enhance Cristin Records with External Metadata}
\usage{
CristinEnhancer(
  cristin.data,
  external.data = NULL,
  use.doi = TRUE,
  use.isbn = TRUE
)
}
\arguments{
\item{cristin.data}{A data frame (or tibble) containing Cristin records. Each row represents a record
that may include fields such as \code{abstractNote}, \code{DOI}, \code{url}, \code{ISBN},
\code{key}, \code{itemType}, \code{pages}, and \code{creators}.}

\item{external.data}{Optional. A data frame or list containing pre-fetched external metadata.
If provided and non-empty, the function will use this external metadata to update the Cristin records
instead of querying the external APIs. Defaults to \code{NULL}.}

\item{use.doi}{Logical; if \code{TRUE} (default), the function will attempt to retrieve external metadata
using DOI information. Defaults to \code{TRUE}.}

\item{use.isbn}{Logical; if \code{TRUE} (default), the function will attempt to retrieve external metadata
using ISBN information when DOI retrieval is not successful. Defaults to \code{TRUE}.}
}
\value{
A data frame containing the enhanced Cristin records with external metadata merged into the original records.
}
\description{
This function iterates over a data frame (or tibble) of Cristin records and attempts to enhance
each record by retrieving additional metadata from external sources. It uses DOI or ISBN information,
via the \code{c2z} package, to fetch external metadata and then merges these updates into the original
Cristin record. Special handling is provided for records representing book sections.
}
\details{
For each record in \code{cristin.data}, the function performs the following steps:

\enumerate{
  \item If \code{external.data} is provided and non-empty, that data is used to update the record.
  \item Otherwise, the function skips processing the record if an abstract already exists.
  \item It then attempts to extract a DOI from the \code{DOI} field, or if missing, from the \code{url} field.
  \item The \code{ISBN} field is processed by removing spaces and extracting the first value (in case of comma separation).
  \item If a valid DOI is found and \code{use.doi} is \code{TRUE}, external metadata is retrieved using \code{c2z::ZoteroDoi()}.
        Otherwise, if an ISBN is available and \code{use.isbn} is \code{TRUE}, metadata is retrieved using \code{c2z::ZoteroIsbn()}.
  \item Once external metadata is successfully retrieved, an internal helper function \code{UpdateTibble} is called.
        This helper function merges the external metadata into the original record. For book sections, additional
        adjustments are made to handle creator information, pages, and edition fields.
  \item Finally, the enhanced record is merged back into the original data frame using \code{UpdateInsert()}.
}
}
\examples{
\dontrun{
  # Enhance Cristin records using DOI/ISBN lookup:
  enhanced_data <- CristinEnhancer(cristin_df)

  # Alternatively, use predefined external metadata and disable DOI lookup:
  enhanced_data <- CristinEnhancer(cristin_df, external.data = some_external_df, use.doi = FALSE, use.isbn = TRUE)
}

}
